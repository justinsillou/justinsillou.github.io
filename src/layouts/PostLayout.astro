---
import BaseLayout from "./BaseLayout.astro";
const { frontmatter } = Astro.props;

const formattedDate = new Date(frontmatter.pubDate).toLocaleDateString(
  "fr-FR",
  { year: "numeric", month: "long", day: "numeric" }
);
---

<BaseLayout pageTitle={frontmatter.title}>
  <article class="max-w-3xl mx-auto w-full overflow-x-hidden">

    {frontmatter.draft && (
      <div class="w-full bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 px-4 py-2 mb-6 rounded flex flex-col sm:flex-row sm:justify-between sm:items-center">
        <span class="font-semibold">‚ö† Article en cours de r√©daction</span>
        <span class="text-sm text-yellow-900 mt-1 sm:mt-0">
          Derni√®re modification : {new Date(frontmatter.derniereModification).toLocaleDateString("fr-FR", { year:"numeric", month:"long", day:"numeric" })}
        </span>
      </div>
    )}

    <!-- üñºÔ∏è Image de couverture -->
    {
      frontmatter.image?.url && (
        <>
          <img
            src={frontmatter.image.url}
            alt={frontmatter.image.alt || frontmatter.title}
            class="w-full h-64 object-cover rounded-2xl shadow-md mb-2"
          />

          <!-- ‚úÖ Mention de source / cr√©dit -->
          {(frontmatter.image.source || frontmatter.image.credit) && (
            <p class="text-sm text-gray-500 italic mb-8">
              Image principale : {frontmatter.image.alt || frontmatter.title}
              {frontmatter.image.source && (
                <>
                  {" ‚Äî "}
                  <a
                    href={frontmatter.image.source}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="underline hover:text-blue-600"
                  >
                    {frontmatter.image.source}
                  </a>
                </>
              )}
              <br />
              {frontmatter.image.credit && (
                <span>(Source : {frontmatter.image.credit})</span>
              )}
            </p>
          )}
        </>
      )
    }

    <!-- üìù Titre -->
    <h1 class="text-4xl font-bold text-gray-900 mb-3">{frontmatter.title}</h1>

    <!-- üìÖ M√©tadonn√©es -->
    <div class="flex flex-wrap items-center text-sm text-gray-500 mb-6 gap-3">
      {frontmatter.draft ? <span>Date non d√©termin√©e</span> : <span>{formattedDate}</span>}
      {
        frontmatter.author && (
          <>
            <span class="text-gray-400">‚Ä¢</span>
            <span>
              √âcrit par{" "}
              <span class="font-medium text-gray-700">
                {frontmatter.author}
              </span>
            </span>
          </>
        )
      }
    </div>

    <!-- üí¨ Description -->
    {
      frontmatter.description && (
        <p class="text-lg text-gray-700 italic mb-8 border-l-4 border-blue-400 pl-4">
          {frontmatter.description}
        </p>
      )
    }

    <!-- Le contenu de ton article ici -->
    <div class="max-w-full overflow-x-auto">
      <slot />
    </div>

    <!-- ü§ñ Mention IA (avant les tags) -->
    {
      frontmatter.IAGenerated && (
        <div class="mt-8 mb-6 text-blue-700 flex items-center text-sm">
          <span
            class="inline-flex items-center justify-center w-5 h-5 mr-2 border border-blue-600 rounded-full font-semibold"
            title="Information"
          >
            i
          </span>
          Cet article a √©t√© g√©n√©r√© par l‚ÄôIA.
        </div>
      )
    }

    <!-- üè∑Ô∏è Tags -->
    {
      frontmatter.tags && frontmatter.tags.length > 0 && (
        <div class="mt-4 flex flex-wrap gap-3">
          {frontmatter.tags.map((tag: string) => (
            <a
              href={`/tags/${tag}`}
              class="bg-blue-100 text-blue-600 text-sm px-3 py-1 rounded-full hover:bg-blue-200 transition"
            >
              #{tag}
            </a>
          ))}
        </div>
      )
    }
  </article>
</BaseLayout>
